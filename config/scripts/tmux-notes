#!/usr/bin/env bash
# Returns path to project-specific notes file (creates template if needed)
# Used by tmux binding: display-popup -E 'nvim "$(tmux-notes)"'

pane_path=$(tmux display-message -p '#{pane_current_path}')
git_root=$(cd "$pane_path" && git rev-parse --show-toplevel 2>/dev/null)

if [[ -n "$git_root" ]]; then
  project_key="${git_root//\//-}"
  notes_dir="$HOME/.claude/projects/${project_key}/notes"
else
  notes_dir="$HOME/.claude/notes"
fi

mkdir -p "$notes_dir"
notes_file="$notes_dir/todo.md"

if [[ ! -f "$notes_file" ]]; then
  cat > "$notes_file" << 'TEMPLATE'
# Todo

## In Progress

## Backlog

## Done

TEMPLATE
fi

echo "$notes_file"
